# 红黑树


## 红-黑树特征

### (1)节点都有颜色;
在红-黑树中，每个节点或者是黑色的或者是红色的。也可以是任意的两种颜色(如蓝色和黄色也是可以的)。实际上，所说的节点有"颜色"是任意的比方。可以使用其他类似方法来表示:比如可以说每一个节点不是深色的就是浅色的，或者说不是阴九阳。不过，颜色便于标记。在节点类中增加一个数据字段，可以是boolean(例如，isRed)，以此来表示颜色的信息。

### (2)在插入和删除的过程中，要遵循保持这些颜色的不同排列的规则;
当插入(或者删除)一个新节点时，必须要遵循的一定的规则，它们被称为红-黑规则。如果遵循这些规则，树就是平衡的。规则如下:

a.每个节点不是红色的就是黑色的;

b.根总是黑色的;

c.如果节点是红色的，则它的子节点必须是黑色的(反之不一定必须为真;)

d.从根到叶节点或空子节点的每条路径，必须包含相同数目的黑色节点;

规则d中的"空子节点"是指非叶节点可以接子节点的位置。换句话说，就是一个有右子节点的节点的可能接左子节点的位置或者是有左子节点的节点的可能接右子节点位置。


## 旋转
为了平衡一棵树，需要重新手动地排列节点。例如，如果所有的系欸但都在根的左侧，就需要把一些节点移到右侧。这使用旋转来实现。

旋转必须一次做如下两件事:

(1)使一些节点上升，一些节点下降，帮助树平衡;

(2)保证不破坏二叉搜索树的特征;


## 红-黑树的效率
和一般的二叉搜索树类似，红-黑树的查找、插入和删除的时间复杂度为O(log2N)。在红-黑树中的查找时间和在普通二叉搜索树中的查找时间应该几乎完全一样，因为在查找的过程中并没有应用红-黑树的特征。额外的开销只是每一个节点的存储空间都稍微增加一点，来存储红-黑的颜色(一个boolean变量)。

在大多数应用中，查找的数次比插入和删除的次数多，所以应用红-黑树取代普通的二叉搜索树总体上不会增加太多的时间开销。当然，红-黑树的优点是对有序数据的操作不会慢到O(N)的时间复杂度。


## 小结
- 保持二叉搜索树的平衡是非常重要的，这样可以使找到给定节点所必需的时间尽可能短。
- 插入有序的数据将创建最不平衡的树，它查找的时间复杂度为O(N)。
- 在红-黑平衡的方法中，每个节点都有一个新的特征:它的颜色不是红的就是黑的。
- 一组称为红-黑规则的规则，详细说明了允许排列不同颜色节点的方法。
- 当插入(或删除)一个节点时应用这些规则。
- 一次颜色变换把一个黑色节点和它的两个红色子节点改成一个红色节点和两个黑色子节点。
- 在一次旋转中，指定一个节点为顶端节点。
- 右旋把顶端节点移到它的右子节点的位置，并把顶端节点的左子节点移到顶端节点的位置。
- 左旋把顶端节点移到它的左子节点的位置，并把顶端节点的右子节点移到顶端节点的位置。
- 当顺着树向下查找新节点的插入位置时，应用颜色变换，并且有时应用旋转。颜色变换通过简单的方法，就使树在插入后恢复成正常的红-黑树。
- 新节点你插入之后，再次检查红-红冲突。如果发现有违背红-黑规则的现象，执行适当的旋转使树恢复红-黑正确性。
- 这些调整使树成功平衡的，或者至少大致平衡。
- 在二叉树中加入红-黑平衡对平均执行效率只有很小的负面影响，然后却避免了对有序的数据操作的最坏的性能。
